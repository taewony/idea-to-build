<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>'Open 도전 목표' 공지방 - 담벼락 스타일</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Gowun Dodum', sans-serif;
            background-color: #D4BFA9;
            /* 기존 앱과 동일한 배경 */
            background-image:
                linear-gradient(rgba(0, 0, 0, 0.07) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 0, 0, 0.07) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .card {
            background-color: white;
            box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 4px 4px 12px rgba(0, 0, 0, 0.15);
        }

        #fab-container {
            cursor: move;
        }

        .interest-btn {
            transition: all 0.2s ease-in-out;
        }

        .interest-btn.active {
            background-color: #fef9c3;
            /* yellow-100 */
            color: #ca8a04;
            /* yellow-600 */
        }

        .interest-btn.active svg {
            fill: #facc15;
            /* yellow-400 */
            stroke: #ca8a04;
            /* yellow-600 */
        }
    </style>
</head>

<body class="p-4 sm:p-6 md:p-8">

    <div class="max-w-2xl mx-auto space-y-6">
        <h1 class="text-3xl font-bold text-center text-gray-800">'Open' 도전 목표 공지방</h1>

        <!-- 도전 목표 목록 -->
        <div id="challenge-list" class="space-y-4">
            <!-- JS로 동적으로 도전 목표 아이템이 추가됩니다. -->
        </div>
    </div>

    <!-- ===== START: Floating Action Button ===== -->
    <div id="fab-container" class="fixed bottom-8 right-8 z-50">
        <div class="w-16 bg-white rounded-full shadow-2xl flex flex-col items-center overflow-hidden">
            <button onclick="alert('TODO 리스트 또는 로그인 화면으로 이동합니다.')"
                class="w-full h-16 flex items-center justify-center text-indigo-600 hover:bg-gray-100 focus:outline-none transition-colors duration-200 cursor-pointer">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor">
                    <path
                        d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
                </svg>
            </button>
            <div class="w-10/12 h-0.5 bg-gray-300"></div>
            <div onclick="alert('AI 비서 기능이 실행됩니다.')"
                class="group relative w-full h-10 flex items-center justify-center cursor-pointer hover:bg-gray-100 active:bg-gray-200 transition-colors duration-200">
                <span class="font-bold text-indigo-600 text-lg">AI</span>
                <div
                    class="absolute top-full mt-3 w-max px-3 py-1.5 bg-gray-900 text-white text-sm rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none left-1/2 -translate-x-1/2">
                    AI 비서 건들기
                    <div
                        class="absolute bottom-full left-1/2 -translate-x-1/2 w-0 h-0 border-x-4 border-x-transparent border-b-4 border-b-gray-900">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- ===== END: Floating Action Button ===== -->

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const challengeList = document.getElementById('challenge-list');

            // --- 샘플 데이터 (날짜는 미래 시점으로 설정) ---
            const challenges = [
                { id: 1, title: '오픈소스 경진대회', deadline: '2026-04-05', participants: 128, interested: false, interestedCount: 42 },
                { id: 2, title: '삼성전자 공개채용', deadline: '2026-05-01', participants: 3450, interested: true, interestedCount: 1234 },
                { id: 3, title: 'AI 스타트업 해커톤', deadline: '2025-11-20', participants: 76, interested: false, interestedCount: 15 },
                { id: 4, title: 'UX/UI 디자인 공모전', deadline: '2025-12-15', participants: 212, interested: true, interestedCount: 88 },
                { id: 5, title: '정부 주관 빅데이터 분석 대회', deadline: '2025-09-30', participants: 45, interested: false, interestedCount: 9 }
            ];

            const calculateDday = (deadline) => {
                const today = new Date();
                const deadlineDate = new Date(deadline);
                today.setHours(0, 0, 0, 0);
                deadlineDate.setHours(0, 0, 0, 0);

                const diffTime = deadlineDate - today;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                if (diffDays < 0) return { text: '마감', color: 'gray' };
                if (diffDays === 0) return { text: 'D-DAY', color: 'red' };
                if (diffDays <= 7) return { text: `D-${diffDays}`, color: 'red' };
                return { text: `D-${diffDays}`, color: 'blue' };
            };

            const renderChallenges = () => {
                challengeList.innerHTML = '';
                if (challenges.length === 0) {
                    challengeList.innerHTML = `<div class="text-center text-gray-500 py-4"><p>현재 진행중인 도전 목표가 없습니다.</p></div>`;
                    return;
                }

                challenges.forEach(challenge => {
                    const challengeItem = document.createElement('div');
                    challengeItem.classList.add('card', 'p-4', 'rounded-lg', 'border', 'border-gray-200');
                    challengeItem.dataset.id = challenge.id;

                    const dDay = calculateDday(challenge.deadline);
                    const dDayColorClasses = {
                        red: 'text-red-600 bg-red-100',
                        blue: 'text-blue-600 bg-blue-100',
                        gray: 'text-gray-600 bg-gray-100'
                    };

                    const interestBtnClass = challenge.interested ? 'active' : '';

                    challengeItem.innerHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <h3 class="text-xl font-bold text-gray-800">${challenge.title}</h3>
                            <div class="text-sm font-bold px-2.5 py-1 rounded-md ${dDayColorClasses[dDay.color]}">${dDay.text}</div>
                        </div>
                        <p class="text-sm text-gray-500 mb-2">신청 기한: ${challenge.deadline}</p>
                        <div class="flex justify-end mb-4">
                            <a href="#" onclick="alert('\\'${challenge.title}\\' 상세 페이지로 이동합니다.'); return false;" class="text-sm font-bold text-indigo-600 hover:underline">자세히 보기 &rarr;</a>
                        </div>
                        <div class="flex justify-between items-center border-t border-gray-200 pt-3">
                            <div class="flex items-center space-x-2 text-gray-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" /></svg>
                                <span class="font-semibold">${challenge.participants.toLocaleString()}명 참여중</span>
                            </div>
                            <div class="flex items-center space-x-4">
                                <span class="text-sm text-gray-500 font-semibold">${challenge.interestedCount.toLocaleString()}명 관심</span>
                                <button class="interest-btn ${interestBtnClass} flex items-center space-x-2 px-4 py-2 rounded-full border border-gray-300 hover:bg-gray-100">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" /></svg>
                                    <span>관심</span>
                                </button>
                            </div>
                        </div>
                    `;
                    challengeList.appendChild(challengeItem);
                });
            };

            challengeList.addEventListener('click', (e) => {
                const interestButton = e.target.closest('.interest-btn');
                if (interestButton) {
                    const challengeItem = interestButton.closest('.card');
                    const challengeId = Number(challengeItem.dataset.id);
                    const challenge = challenges.find(c => c.id === challengeId);

                    if (challenge.interested) {
                        challenge.interestedCount--;
                    } else {
                        challenge.interestedCount++;
                    }
                    challenge.interested = !challenge.interested;

                    renderChallenges(); // Re-render to update the count and button style
                }
            });

            renderChallenges();
        });

        // FAB 드래그 기능
        const fab = document.getElementById('fab-container');
        let isDragging = false, offsetX, offsetY;
        fab.addEventListener('mousedown', (e) => {
            if (e.target.closest('button') || e.target.closest('[onclick]')) return;
            isDragging = true;
            offsetX = e.clientX - fab.getBoundingClientRect().left;
            offsetY = e.clientY - fab.getBoundingClientRect().top;
            fab.style.transition = 'none'; e.preventDefault();
        });
        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            const x = e.clientX - offsetX, y = e.clientY - offsetY;
            fab.style.right = 'auto'; fab.style.bottom = 'auto';
            fab.style.left = `${x}px`; fab.style.top = `${y}px`;
        });
        document.addEventListener('mouseup', () => { if (isDragging) { fab.style.transition = ''; isDragging = false; } });
    </script>

</body>

</html>